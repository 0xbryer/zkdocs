<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The zero-knowledge proof for a discrete-logarithm in a prime modulo."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Schnorr's identification protocol"><meta property="og:description" content="The zero-knowledge proof for a discrete-logarithm in a prime modulo."><meta property="og:type" content="article"><meta property="og:url" content="https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/"><meta property="article:section" content="docs"><title>Schnorr's identification protocol | ZKDocs</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6aece0f96007af353373ec1c05beb9d415830db47ac294f964054d8382bbb1e3.css integrity="sha256-auzg+WAHrzUzc+wcBb651BWDDbR6wpT5ZAVNg4K7seM=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.0f9a1aee3ada78286a5439edf8868b294ef0783d0ffd177e960d9d267cd30cd4.js integrity="sha256-D5oa7jraeChqVDnt+IaLKU7weD0P/Rd+lg2dJnzTDNQ=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-215689345-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script>
<script defer data-domain=zkdocs.com src=https://plausible.io/js/plausible.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class=align-center href=/><img id=icon src=/TOB_Black.svg alt=Logo><div class="flex align-center"><img id=logo src=/logo.png alt=Logo><span>ZKDocs</span></div></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/>Introduction</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/notation/>Notation & Definitions</a></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/>Zero-knowledge protocols</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/ class=active>Schnorr's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/>Variants of Schnorr's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/>Number is product of two primes</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/square-freeness/>Number is square-free</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/two-prime-divisors/>Two prime divisors</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/product-of-two-primes/>Product of two primes</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/paillier_blum_modulus/>Paillier-Blum Modulus</a></li></ul></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/girault-identification/>Girault's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/short-factoring-proofs/>Short factoring proofs</a></li></ul></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/>Security of ZKPs</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/when-to-use-hvzk/>Using HVZKP in the wrong context</a></li></ul></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/>Protocol primitives</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/random-sampling/>Random Sampling</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/nums/>Nothing-up-my-sleeve constructions</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/shamir/>Shamir's Secret Sharing Scheme</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/verifiable-secret-sharing/>Feldman's Verifiable Secret Sharing</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/alt-shamir/>Alternative versions of Shamir's Secret Sharing scheme</a></li></ul></li><li><a href=https://www.zkdocs.com/docs/zkdocs/bibliography/>Bibliography</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><script type=text/x-mathjax-config>
  MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},SVG: {addMMLclasses: true},
    loader: { load: ['[tex]/textmacros','[tex]/newcommand','[tex]/action']},
    tex: { packages: { '[+]': ['newcommand','action', 'textmacros'] }}
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML-full"></script>
<script language=javascript type=text/javascript src=/js/interactive_variables.js></script>
<script>MathJax.Hub.Queue(function(){setupInteractiveVariables()})</script>$\newcommand{\alicebob}[3]{#1 & \ra{#2} & #3\\[-5pt]}$
$\newcommand{\bobalice}[3]{#1 & \la{#2} & #3\\[-5pt]}$
$\newcommand{\alicework}[1]{#1 & &\\[-5pt]}$
$\newcommand{\bobwork}[1]{ & & #1\\[-5pt]}$
$\newcommand{\work}[2]{#1 & & #2\\}$
$\newcommand{\allwork}[1]{ & #1 & \\}$
$\newcommand{\aliceseparator}{-------&&\\}$
$\newcommand{\bobseparator}{&&-------\\}$
$\newcommand{\foo}{\phantom{\text{bigarrowfitsallthis}}}$
$\newcommand{\ra}[1]{%
\vphantom{\xrightarrow{asd}}%
\smash{\xrightarrow[\foo]{#1}}%
}$
$\newcommand{\la}[1]{%
\vphantom{\xleftarrow{asd}}%
\smash{\xleftarrow[\foo]{#1}}%
}$
$\newcommand{\z}[1]{\mathbb{Z}_{#1}}$
$\newcommand{\zq}{\mathbb{Z}_\varq}$
$\newcommand{\zqs}{\mathbb{Z}_q^\ast}$
$\newcommand{\zps}{\mathbb{Z}_p^\ast}$
$\newcommand{\zns}[1]{\mathbb{Z}_{#1}^\ast}$
$\require{action}
\newcommand{\sampleSymb}{
{\overset{\$}{\leftarrow}}
}$
$\newcommand{\field}[1]{\mathbb{F}_{#1}}$
$\newcommand{\sample}[1]{#1\sampleSymb\zq}$
$\newcommand{\sampleGeneric}[2]{#1\sampleSymb#2}$
$\newcommand{\sampleInterval}[2]{#1\sampleSymb\interval{#2}}$
$\newcommand{\sampleRange}[2]{#1\sampleSymb\range{#2}}$
$\newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}}$
$\newcommand{\sampleN}[2]{\class{hover}{#1\sampleSymb\z{#2}}}$
$\newcommand{\sampleNs}[2]{\class{hover}{#1\sampleSymb\z{#2}^\ast}}$
$\newcommand{\equalQ}{\overset{?}{=}}$
$\newcommand{\gQ}{\overset{?}{>}}$
$\newcommand{\inQ}{\overset{?}{\in}}$
$\newcommand{\cgroup}{\mathbb{G}}$
$\newcommand{\hash}[1]{\mathsf{Hash}({#1})}$
$\newcommand{\hashbit}[2]{\mathsf{Hash}({#1})\verb+[0:#2]+}$
$\newcommand{\naturals}{\mathbb{N}}$
$\newcommand{\sqfree}{L_\mathsf{square-free}}$
$\newcommand{\ceil}[1]{\lceil #1 \rceil}$
$\newcommand{\sampleSet}[2]{\class{hover}{#1\sampleSymb#2}}$
$\newcommand{\bunch}[1]{\{ #1_i\}_{i=1}^m}$
$\newcommand{\bunchi}[1]{\{ #1\}_{i=1}^m}$
$\newcommand{\forb}{\text{ for }i=1,\ldots,m}$
$\newcommand{\interval}[1]{[0, #1[}$
$\newcommand{\range}[1]{[#1]}$
$\newcommand{\rangeone}[1]{\{1, \dots,#1 -1 \}}$
$\newcommand{\vara}{\class{var var_a}{a}}$
$\newcommand{\varb}{\class{var var_b}{b}}$
$\newcommand{\varc}{\class{var var_c}{c}}$
$\newcommand{\vard}{\class{var var_d}{d}}$
$\newcommand{\varh}{\class{var var_h}{h}}$
$\newcommand{\varg}{\class{var var_g}{g}}$
$\newcommand{\varu}{\class{var var_u}{u}}$
$\newcommand{\varx}{\class{var var_x}{x}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varz}{\class{var var_z}{z}}$
$\newcommand{\varr}{\class{var var_r}{r}}$
$\newcommand{\varq}{\class{var var_q}{q}}$
$\newcommand{\varp}{\class{var var_p}{p}}$
$\newcommand{\vare}{\class{var var_e}{e}}$
$\newcommand{\vary}{\class{var var_y}{y}}$
$\newcommand{\varw}{\class{var var_w}{w}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}}$
$\newcommand{\varN}{\class{var var_N}{N}}$
$\newcommand{\rhovar}{\class{var var_ρ}{\rho}}$
$\newcommand{\sigmavar}{\class{var var_σ}{\sigma}}$
$\newcommand{\thetavar}{\class{var var_θ}{\theta}}$
$\newcommand{\muvar}{\class{var var_μ}{\mu}}$
$\newcommand{\true}{\mathsf{true}}$
$\newcommand{\false}{\mathsf{false}}$<div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Schnorr's identification protocol</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#security-pitfalls>Security pitfalls</a></li><li><a href=#security-assumptions>Security assumptions</a></li></ul></nav></aside></header><article class=markdown><h1 id=schnorrs-identification-protocol>Schnorr&rsquo;s identification protocol
<a class=anchor href=#schnorrs-identification-protocol>#</a></h1><p>Schnorr&rsquo;s identification protocol is the simplest example of a zero-knowledge protocol. With it,
$\varprover$ can convince $\varverifier$ that they know the discrete logarithm $\varx$ of some value
$\varh = \varg^\varx$, without revealing $\varx$.</p><blockquote class="book-hint info"><strong>Goal:</strong>
$\varprover$ convinces $\varverifier$ that they know $\varx$ such that $\varh = \varg^\varx$.</blockquote><ul><li><strong>Public input:</strong> cyclic group $\cgroup$ of prime order $\varq$, a $\cgroup$ generator $\varg$ and $\varh\in \cgroup$.</li><li><strong>Private input:</strong> $\varprover$ knows secret $\varx\in\zq$ such that $\varh = \varg^\varx$.</li></ul><div class=book-tabs><input type=radio class=toggle name=tabs-uniqueid id=tabs-uniqueid-0 checked>
<label for=tabs-uniqueid-0>Multiplicative notation</label><div class="book-tabs-content markdown-inner"><h3 id=interactive-protocol>Interactive protocol
<a class=anchor href=#interactive-protocol>#</a></h3><p>The Schnorr interactive identification protocol</p><p>$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\samplezqs{\varr}}
\alicework{\varu = \varg^\varr}
\alicebob{}{\varu}{}
\bobwork{\sample{\varc}}
\bobalice{}{\varc}{}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varz}{}
\bobwork{\varg^{\varz} \equalQ \varu \cdot \varh^\varc }
\end{array}
$$</p><hr><h3 id=non-interactive-protocol>Non-interactive protocol
<a class=anchor href=#non-interactive-protocol>#</a></h3><p>We can transform this identification scheme into a non-interactive protocol using the Fiat-Shamir heuristic. Here, the prover creates the random challenge $c$ hashing <em>all</em> public values $\{\varg, \varq, \varh, \varu\}$.</p><p>$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\samplezqs{\varr}}
\alicework{\varu = \varg^\varr}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varu, \varc, \varz}{}
\bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
\bobwork{\varg^\varz \equalQ \varu \cdot \varh ^\varc }
\end{array}
$$</p></div><input type=radio class=toggle name=tabs-uniqueid id=tabs-uniqueid-1>
<label for=tabs-uniqueid-1>Additive notation</label><div class="book-tabs-content markdown-inner"><h3 id=interactive-protocol>Interactive protocol
<a class=anchor href=#interactive-protocol>#</a></h3><p>The Schnorr interactive identification protocol</p><p>$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\samplezqs{\varr}}
\alicework{\varu = \varr\cdot\varg}
\alicebob{}{\varu}{}
\bobwork{\sample{\varc}}
\bobalice{}{\varc}{}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varz}{}
\bobwork{\varz\cdot\varg \equalQ \varu + \varc\cdot\varh }
\end{array}
$$</p><hr><h3 id=non-interactive-protocol>Non-interactive protocol
<a class=anchor href=#non-interactive-protocol>#</a></h3><p>We can transform this identification scheme into a non-interactive protocol using the Fiat-Shamir heuristic. Here, the prover creates the random challenge $c$ hashing <em>all</em> public values $\{\varg, \varq, \varh, \varu\}$.</p><p>$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\samplezqs{\varr}}
\alicework{\varu = \varr\cdot \varg}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varu, \varc, \varz}{}
\bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
\bobwork{\varz \cdot \varg \equalQ \varu + \varc\cdot\varh}
\end{array}
$$</p></div></div><h2 id=security-pitfalls>Security pitfalls
<a class=anchor href=#security-pitfalls>#</a></h2><ul><li><strong>Verifier trusts prover:</strong> On the verification check, the verifier uses $g$ and $q$ provided with the proof instead of using publicly known values. On the NI version, the verifier assumes that the hash $\varc$ is correctly computed and does not compute it themself. Both are high severity issues since $\varprover$ can forge proofs.</li><li><strong>Weak Fiat-Shamir transformation:</strong> In the non-interactive protocol, it is a common occurrence that some parameters are missing on the hash computation $\hash{\varg, \varq, \varh, \varu}$:<ul><li>$\varh$ or $\varu$ missing: high severity issue. Read <a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a> for more details.</li><li>$\varg$ or $\varq$ missing: usually no issue, but it might be one if the Verifier uses these parameters directly from the proof structure. This way, the prover can provide bad generators or orders to forge the proof.</li></ul></li><li><strong>Weak randomness:</strong> Bad randomness may cause the secret $\varx$ to leak. If $\varr$ is reused twice with two different interactive challenges, or different data on the non-interactive version then
$$ \frac{\varz - \varz&rsquo;}{\varc-\varc&rsquo;} = \frac{\varr -\varr + \varx\cdot(\varc - \varc&rsquo;)}{\varc-\varc&rsquo;} = \varx $$</li><li><strong>Replay attacks:</strong> After a non-interactive proof is public, it will always be valid and anyone could pretend to know the secret value. To prevent this, consider adding the ID of both the prover and the verifier inside of the Fiat-Shamir hash computation.</li></ul><h2 id=security-assumptions>Security assumptions
<a class=anchor href=#security-assumptions>#</a></h2><ul><li><strong>Hash function:</strong> The hash function should be either <a href=https://www.nist.gov/publications/sha-3-derived-functions-cshake-kmac-tuplehash-and-parallelhash>TupleHash</a> or SHA-256 where each input is domain separated with a unique string together with the length of each element.</li><li><strong>Hardness of the discrete logarithm:</strong> The order of the cyclic group $\cgroup$ should be at least $\varq>2^{K}$ where $K=256$, for a generic group $\cgroup$. If $\cgroup$ is a (prime-order) subgroup of $\zps$, then $p$ should be greater than $2^{\kappa}$ for $\kappa=3072$ to avoid <a href=https://en.wikipedia.org/wiki/Index_calculus_algorithm>subexponential attacks</a> based on the extra structure of $\zps$. Note that this requires $p - 1 = q\cdot r$ with some potentially composite number $r$. Refer to table 2 (pp. 54-55) of <a href=https://doi.org/10.6028/NIST.SP.800-57pt1r5>the NIST recommendations</a> for an overview of different bit security levels for finite field discrete logarithms.</li></ul><h2>References <a class=anchor href=#references>#</a></h2><ul><li>[Sch91] <a href=https://link.springer.com/content/pdf/10.1007/BF00196725.pdf title="Schnorr, C. P. (1991). Efficient signature generation by smart cards. Journal of cryptology, 4(3), 161-174" target=_blank>Efficient signature generation by smart cards</a> (1991).</li></ul><ul><li><a href=https://crypto.stanford.edu/cs355/19sp/lec5.pdf title target=_blank>Lectures on Schnorr's protocol</a>.</li></ul><ul><li>[SHA3] <a href=https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-185.pdf title="Kelsey, J., Chang, S. J., & Perlner, R. (2016). SHA-3 derived functions: cSHAKE, KMAC, TupleHash and ParallelHash. NIST special publication, 800, 185." target=_blank>SHA-3 derived functions: cSHAKE, KMAC, TupleHash and ParallelHash</a> (2016).</li></ul><ul><li>[NSPUE2] <a href=https://doi.org/10.6028/NIST.SP.800-57pt1r5 title="National Institute of Standards and Technology (2020, May). Recommendation for Key Management: Part 1 — General. Special Publication 800-57 Part 1, Revision 5" target=_blank>Recommendation for Key Management: Part 1 — General</a> (2020).</li></ul><ul><li><a href=https://en.wikipedia.org/wiki/Index_calculus_algorithm title target=_blank>Index calculus algorithm</a>.</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><article class=markdown><br><br><hr><div style=text-align:right><a href=https://github.com/trailofbits/zkdocs target=_blank>View on Github</a> | <a href=https://www.trailofbits.com/ target=_blank>Trail of Bits</a> |
<a href=https://blog.trailofbits.com/ target=_blank>Trail of Bits Blog</a></div><div style=text-align:right><small>ZKDocs content is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank>Creative Commons Attribution 4.0 International license.</a></small></div></article></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#security-pitfalls>Security pitfalls</a></li><li><a href=#security-assumptions>Security assumptions</a></li></ul></nav><br><br><button class=book-btn onclick=resetVariableNames()>Reset variables names</button></div></aside></main></body></html>