<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="An overview of the Pedersen commitment scheme and its applications"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Pedersen Commitments"><meta property="og:description" content="An overview of the Pedersen commitment scheme and its applications"><meta property="og:type" content="article"><meta property="og:url" content="https://www.zkdocs.com/docs/zkdocs/commitments/pedersen/"><meta property="article:section" content="docs"><title>Pedersen Commitments | ZKDocs</title>
<link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.6aece0f96007af353373ec1c05beb9d415830db47ac294f964054d8382bbb1e3.css integrity="sha256-auzg+WAHrzUzc+wcBb651BWDDbR6wpT5ZAVNg4K7seM=" crossorigin=anonymous><script defer src=/flexsearch.min.js></script><script defer src=/en.search.min.efb8dda88c29c848a340ea08957296610e56a3fd40e2b12ef92e19a7cabeac93.js integrity="sha256-77jdqIwpyEijQOoIlXKWYQ5Wo/1A4rEu+S4Zp8q+rJM=" crossorigin=anonymous></script><script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-215689345-1","auto"),ga("send","pageview"))</script><script async src=https://www.google-analytics.com/analytics.js></script><script type=text/javascript id=hs-script-loader async defer src=//js.hs-scripts.com/22554992.js></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class=align-center href=/><img id=icon src=/TOB_Black.svg alt=Logo><div class="flex align-center"><img id=logo src=/logo.png alt=Logo><span>ZKDocs</span></div></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/>Introduction</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/notation/>Notation & Definitions</a></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/>Zero-knowledge protocols</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/>Schnorr's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/>Variants of Schnorr's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/>Number is product of two primes</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/square-freeness/>Number is square-free</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/two-prime-divisors/>Two prime divisors</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/product-of-two-primes/>Product of two primes</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/paillier_blum_modulus/>Paillier-Blum Modulus</a></li></ul></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/girault-identification/>Girault's identification protocol</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/short-factoring-proofs/>Short factoring proofs</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/ipa/>Inner Product Argument</a></li></ul></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/>Security of ZKPs</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/when-to-use-hvzk/>Using HVZKP in the wrong context</a></li></ul></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/>Protocol primitives</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/random-sampling/>Random Sampling</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/nums/>Nothing-up-my-sleeve constructions</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/shamir/>Shamir's Secret Sharing Scheme</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/verifiable-secret-sharing/>Feldman's Verifiable Secret Sharing</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/alt-shamir/>Alternative versions of Shamir's Secret Sharing scheme</a></li></ul></li><li class=book-section-flat><a href=https://www.zkdocs.com/docs/zkdocs/commitments/>Commitment Schemes</a><ul><li><a href=https://www.zkdocs.com/docs/zkdocs/commitments/pedersen/ class=active>Pedersen Commitments</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/commitments/kzg_polynomial_commitment/>KZG Polynomial Commitments</a></li><li><a href=https://www.zkdocs.com/docs/zkdocs/commitments/ipa-pcs/>IPA Polynomial Commitment</a></li></ul></li><li><a href=https://www.zkdocs.com/docs/zkdocs/bibliography/>Bibliography</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><script type=text/x-mathjax-config>
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},SVG: {addMMLclasses: true},
  loader: { load: ['[tex]/textmacros','[tex]/newcommand','[tex]/action'] },
  tex: { packages: { '[+]': ['newcommand','action', 'textmacros'] } }
});
</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML-full"></script><script language=javascript type=text/javascript src=/js/interactive_variables.js></script><script>MathJax.Hub.Queue(function(){setupInteractiveVariables()})</script>$\newcommand{\coinheads}{\mathsf{HEADS}}$
$\newcommand{\cointails}{\mathsf{TAILS}}$
$\newcommand{\varalice}{\class{var var_Alice}{\text{Alice}}}$
$\newcommand{\varbob}{\class{var var_Bob}{\text{Bob}}}$
$\newcommand{\alicebob}[3]{#1 & \ra{#2} & #3\\[-5pt]}$
$\newcommand{\bobalice}[3]{#1 & \la{#2} & #3\\[-5pt]}$
$\newcommand{\alicework}[1]{#1 & &\\[-5pt]}$
$\newcommand{\bobwork}[1]{ & & #1\\[-5pt]}$
$\newcommand{\work}[2]{#1 & & #2\\}$
$\newcommand{\allwork}[1]{ & #1 & \\}$
$\newcommand{\dupwork}[1]{#1 & & #1\\}$
$\newcommand{\aliceseparator}{-------&&\\}$
$\newcommand{\bobseparator}{&&-------\\}$
$\newcommand{\foo}{\phantom{\text{bigarrowfitsallthis}}}$
$\newcommand{\ra}[1]{%
\vphantom{\xrightarrow{asd}}%
\smash{\xrightarrow[\foo]{#1}}%
}$
$\newcommand{\la}[1]{%
\vphantom{\xleftarrow{asd}}%
\smash{\xleftarrow[\foo]{#1}}%
}$
$\newcommand{\z}[1]{\mathbb{Z}_{#1}}$
$\newcommand{\zq}{\mathbb{Z}_\varq}$
$\newcommand{\zqs}{\mathbb{Z}_q^\ast}$
$\newcommand{\zps}{\mathbb{Z}_p^\ast}$
$\newcommand{\zns}[1]{\mathbb{Z}_{#1}^\ast}$
$\require{action}
\newcommand{\sampleSymb}{
{\overset{\$}{\leftarrow}}
}$
$\newcommand{\field}[1]{\mathbb{F}_{#1}}$
$\newcommand{\sample}[1]{#1\sampleSymb\zq}$
$\newcommand{\sampleGeneric}[2]{#1\sampleSymb#2}$
$\newcommand{\sampleInterval}[2]{#1\sampleSymb\interval{#2}}$
$\newcommand{\sampleRange}[2]{#1\sampleSymb\range{#2}}$
$\newcommand{\sampleCgroup}[1]{#1\sampleSymb\cgroup}$
$\newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}}$
$\newcommand{\sampleN}[2]{\class{hover}{#1\sampleSymb\z{#2}}}$
$\newcommand{\sampleNs}[2]{\class{hover}{#1\sampleSymb\z{#2}^\ast}}$
$\newcommand{\equalQ}{\overset{?}{=}}$
$\newcommand{\gQ}{\overset{?}{>}}$
$\newcommand{\inQ}{\overset{?}{\in}}$
$\newcommand{\cgroup}{\mathbb{G}}$
$\newcommand{\Hash}{\mathsf{Hash}}$
$\newcommand{\hash}[1]{\Hash({#1})}$
$\newcommand{\HashToField}{\mathsf{HashToField}}$
$\newcommand{\hashtofield}[1]{\HashToField({#1})}$
$\newcommand{\HashToGroup}{\mathsf{HashToGroup}}$
$\newcommand{\hashtogroup}[1]{\HashToGroup({#1})}$
$\newcommand{\hashbit}[2]{\mathsf{Hash}({#1})\verb+[0:#2]+}$
$\newcommand{\hmac}[2]{\mathsf{HMAC}_{#1}\left(#2\right)}$
$\newcommand{\naturals}{\mathbb{N}}$
$\newcommand{\sqfree}{L_\mathsf{square-free}}$
$\newcommand{\ceil}[1]{\lceil #1 \rceil}$
$\newcommand{\sampleSet}[2]{\class{hover}{#1\sampleSymb#2}}$
$\newcommand{\bunch}[1]{\{ #1_i\}_{i=1}^m}$
$\newcommand{\bunchi}[1]{\{ #1\}_{i=1}^m}$
$\newcommand{\forb}{\text{ for }i=1,\ldots,m}$
$\newcommand{\interval}[1]{[0, #1[}$
$\newcommand{\range}[1]{[#1]}$
$\newcommand{\rangeone}[1]{\{1, \dots,#1 -1 \}}$
$\newcommand{\vara}{\class{var var_a}{a}}$
$\newcommand{\varb}{\class{var var_b}{b}}$
$\newcommand{\varc}{\class{var var_c}{c}}$
$\newcommand{\vard}{\class{var var_d}{d}}$
$\newcommand{\varh}{\class{var var_h}{h}}$
$\newcommand{\varH}{\class{var var_H}{H}}$
$\newcommand{\varg}{\class{var var_g}{g}}$
$\newcommand{\varG}{\class{var var_G}{G}}$
$\newcommand{\vari}{\class{var var_i}{i}}$
$\newcommand{\varj}{\class{var var_j}{j}}$
$\newcommand{\vars}{\class{var var_s}{s}}$
$\newcommand{\vart}{\class{var var_t}{t}}$
$\newcommand{\varu}{\class{var var_u}{u}}$
$\newcommand{\varU}{\class{var var_U}{U}}$
$\newcommand{\varl}{\class{var var_l}{l}}$
$\newcommand{\varm}{\class{var var_m}{m}}$
$\newcommand{\varn}{\class{var var_n}{n}}$
$\newcommand{\varx}{\class{var var_x}{x}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varz}{\class{var var_z}{z}}$
$\newcommand{\varr}{\class{var var_r}{r}}$
$\newcommand{\varq}{\class{var var_q}{q}}$
$\newcommand{\varp}{\class{var var_p}{p}}$
$\newcommand{\vare}{\class{var var_e}{e}}$
$\newcommand{\vary}{\class{var var_y}{y}}$
$\newcommand{\varv}{\class{var var_v}{v}}$
$\newcommand{\varw}{\class{var var_w}{w}}$
$\newcommand{\varC}{\class{var var_C}{C}}$
$\newcommand{\varf}{\class{var var_f}{f}}$
$\newcommand{\varA}{\class{var var_A}{A}}$
$\newcommand{\varB}{\class{var var_B}{B}}$
$\newcommand{\varC}{\class{var var_C}{C}}$
$\newcommand{\varL}{\class{var var_L}{L}}$
$\newcommand{\varP}{\class{var var_P}{P}}$
$\newcommand{\varR}{\class{var var_R}{R}}$
$\newcommand{\varT}{\class{var var_T}{T}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varalpha}{\class{var var_alpha}{\alpha}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}}$
$\newcommand{\varN}{\class{var var_N}{N}}$
$\newcommand{\rhovar}{\class{var var_ρ}{\rho}}$
$\newcommand{\sigmavar}{\class{var var_σ}{\sigma}}$
$\newcommand{\thetavar}{\class{var var_θ}{\theta}}$
$\newcommand{\muvar}{\class{var var_μ}{\mu}}$
$\renewcommand{\vec}[1]{\mathbf{#1}}$
$\newcommand{\veca}{\vec{\class{var var_vec_a}{a}}}$
$\newcommand{\vecb}{\vec{\class{var var_vec_b}{b}}}$
$\newcommand{\vecc}{\vec{\class{var var_vec_c}{c}}}$
$\newcommand{\vecs}{\vec{\class{var var_vec_s}{s}}}$
$\newcommand{\vecG}{\vec{\class{var var_vec_G}{G}}}$
$\newcommand{\vecH}{\vec{\class{var var_vec_H}{H}}}$
$\newcommand{\vecg}{\vec{\class{var var_vec_g}{g}}}$
$\newcommand{\vech}{\vec{\class{var var_vec_h}{h}}}$
$\newcommand{\true}{\mathsf{true}}$
$\newcommand{\false}{\mathsf{false}}$
$\newcommand{\ctx}{\mathsf{ctx}}$
$\newcommand{\coloneqq}{&#8788;}$
$\newcommand{\ip}[2]{\left\langle #1, #2 \right\rangle}$
$\newcommand{\uwork}[2]{\underline{#1} & & \underline{#2}\\}$

$\newcommand{\aliceworks}[1]{#1 & &\\[-2pt]}$
$\newcommand{\bobworks}[1]{ & & #1\\[-2pt]}$

$\newcommand{\Halving}{\text{Halving}}$
$\newcommand{\HalveProof}{\text{HalveProof}}$
$\newcommand{\HalveVerify}{\text{HalveVerify}}$
$\newcommand{\indent}{\qquad}$
$\newcommand{\append}{\mathrm{append}}$
$\newcommand{\schnorrvalidate}{\mathsf{schnorr}\_\mathsf{validate}}$<div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu>
</label><strong>Pedersen Commitments</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#definition>Definition</a><ul><li><a href=#intuition-as-to-why-pedersen-commitments-are-binding>Intuition as to Why Pedersen Commitments are Binding</a></li><li><a href=#intuition-as-to-why-pedersen-commitments-are-hiding>Intuition as to Why Pedersen Commitments are Hiding</a></li><li><a href=#the-additive-property>The Additive Property</a></li></ul></li><li><a href=#useful-algorithms-and-properties-of-pedersen-commitments>Useful Algorithms and Properties of Pedersen Commitments</a><ul><li><a href=#proof-of-knowledge-of-secret>Proof of Knowledge of Secret</a></li><li><a href=#an-easy-proof-of-equal-commitments>An Easy Proof of Equal Commitments</a></li><li><a href=#proof-of-equal-commitments-with-different-binding-generators>Proof of Equal Commitments with Different Binding Generators</a></li><li><a href=#proof-of-squared-commitments>Proof of Squared Commitments</a></li></ul></li><li><a href=#security-considerations>Security Considerations</a><ul><li><a href=#generator-selection>Generator Selection</a></li><li><a href=#random-number-generator-issues>Random Number Generator Issues</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=pedersen-commitments>Pedersen Commitments
<a class=anchor href=#pedersen-commitments>#</a></h1><p>Pedersen commitments were originally described as part of Pedersen&rsquo;s verifiable secret-sharing scheme in 1992. Section 3 of the Pedersen paper notes that the commitment scheme is &ldquo;very similar&rdquo; to a scheme proposed by Bos, Chaum, and Purdy in an unpublished set of notes proposing a voting system.</p><p>Pedersen commitments are simple. Committing to a value requires only two modular exponentiations and a multiplication. Because a random value is required for each commitment, commitments are non-deterministic. And, because Pedersen commitments rely heavily on group structure, they inherit a large number of useful properties that allow for useful operations and proofs for the committed values.</p><p>Pedersen&rsquo;s original proposal described the commitment in terms of order-$q$ subgroups of $\zns{p}$, but we will describe it in more generic terms, as it is applicable to any group $G$ where the discrete logarithm problem is believed to be hard (such as elliptic curve groups).</p><h2 id=definition>Definition
<a class=anchor href=#definition>#</a></h2><p>Start with a finite group $G$ of prime order $q$, where $q$ is suitably large. For instance, we can use an order-$q$ subgroup the multiplicative group $\zps$ where $q$ divides $p$, or an elliptic curve group or subgroup. Select two generators $g,h$ of $G$ such that $\log_{g}\left(h\right)$ is not known. The parameters of the commitment scheme are $\left(G,q,g,h\right)$.</p><p>To generate a commitment $c\in G$ to a secret integer $s$, where $0 &lt; s &lt; q$, randomly sample $\sampleN{t}{\varq}$ and compute:</p><p>$$
c = C_{g,h}\left(s,t\right)=g^{s}h^{t}
$$</p><p>(When $g,h$ are clear from context, we can simply write $C\left(s,t\right)$.)</p><p>To open the commitment, simply reveal $s$ and $t$.</p><h3 id=intuition-as-to-why-pedersen-commitments-are-binding>Intuition as to Why Pedersen Commitments are Binding
<a class=anchor href=#intuition-as-to-why-pedersen-commitments-are-binding>#</a></h3><p>Suppose Alice has sent Bob a commitment $c=C\left(s,t\right)$ to a value $s$. She now wants to cheat by sending Bob an opening for $c$ that corresponds to $s&rsquo;\neq s$. In other words, she wants to break the binding property of Pedersen commitments.</p><p>That means Alice has to find $t&rsquo;$ such that $g^{s&rsquo;}h^{t&rsquo;}=c$. Since $g^{s&rsquo;}$ and $c$ are already fixed, Alice is left to solve $h^{t&rsquo;}=cg^{-s&rsquo;}$. In other words, she needs to compute $t&rsquo;=\log_{h}\left(cg^{-s&rsquo;}\right)$. Since the discrete logarithm problem is supposed to be hard in $G$, Alice will have a difficult time finding $t&rsquo;$.</p><p>Before committing to a value, Alice can also look for distinct pairs $\left(s,t\right),\left(s&rsquo;,t&rsquo;\right)$ such that $C\left(s,t\right)=C\left(s&rsquo;,t&rsquo;\right)$, without regard for the specific values of $s$ and $s&rsquo;$. This is <em>also</em> equivalent to computing a discrete logarithm in $G$. As the Pedersen paper points out: given $C\left(s,t\right)=C\left(s&rsquo;,s&rsquo;\right)$, where $s&rsquo;\neq s$, then $t&rsquo;\neq t$, and it is possible to compute the discrete logarithm of $h$ with respect to $g$:</p><p>$$
\log_{g}\left(h\right)=\frac{s-s&rsquo;}{t&rsquo;-t}\pmod{q}
$$</p><p>To summarize, breaking the binding property of Pedersen commitments is equivalent to solving the discrete log problem.</p><h3 id=intuition-as-to-why-pedersen-commitments-are-hiding>Intuition as to Why Pedersen Commitments are Hiding
<a class=anchor href=#intuition-as-to-why-pedersen-commitments-are-hiding>#</a></h3><p>Suppose Alice has sent Bob a commitment $c=C\left(s,t\right)$ to a value $s$. Bob wants to cheat by figuring out $s$, or at least something <em>about</em> $s$, from $c$.</p><p>Remember that $t$ is sampled uniformly at random, and so every value of $t$ is equally likely to be chosen, which means every value of $h^{t}$ is equally likely. Since $h$ is a generator of $G$, that means that $t$ &ldquo;selects&rdquo; every element of $G$ uniformly at random.</p><p>If Bob is able to gain any advantage in guessing the value of $s$ or $g^{s}$ from $c$, then he necessarily gains an advantage in guessing $t$ or $h^{t}$. However, $t$ is selected uniformly at random, so $h^{t}$ is a uniform random element of $G$. You can&rsquo;t gain information about a uniform random distribution.</p><h3 id=the-additive-property>The Additive Property
<a class=anchor href=#the-additive-property>#</a></h3><p>Given two commitments, $c_{1}=C\left(s_{1},t_{2}\right)=g^{s_{1}}h^{t_{1}}$ and $c_{2}=C\left(s_{2}, t_{2}\right)=g^{s_{2}}h^{t_{2}}$, the product of $c_{1}$ and $c_{2}$ is $g^{s_{1}+s_{2}}h^{t_{1}+t_{2}} = C\left(s_{1}+s_{2},t_{1}+t_{2}\right)$. That is, the product of any two Pedersen commitments is a commitment to the sum of the committed values.</p><p>This also allows for scalar multiplication through exponentiation; $C\left(x,y\right)^{n}=C\left(nx,ny\right)$.</p><p>This additive property can be incredibly useful. It allows for a variety of operations to be performed on committed values before revealing them. Systems like Bulletproofs, for instance, exploit this property of the Pedersen scheme to commit to entire <em>vectors</em> of values at once, aggregating the commitments into a single value.</p><h2 id=useful-algorithms-and-properties-of-pedersen-commitments>Useful Algorithms and Properties of Pedersen Commitments
<a class=anchor href=#useful-algorithms-and-properties-of-pedersen-commitments>#</a></h2><h3 id=proof-of-knowledge-of-secret>Proof of Knowledge of Secret
<a class=anchor href=#proof-of-knowledge-of-secret>#</a></h3><p>Given a commitment $A=C_{g,h}\left(x,y\right)=g^{x}h^{y}$, Alice can demonstrate to Bob that she knows $x$ and $y$ without revealing either $x$ or $y$. This is a useful protocol for protecting against the additive properties of Pedersen commitments being used maliciously. The protocol works as follows:</p>$$
\begin{array}{c}
\work{\varalice}{\varbob}
\alicework{\sampleN{t_{1},t_{2}}{\varq}}
\alicework{T = g^{t_{1}}h^{t_{2}}}
\alicebob{}{T}{}
\bobwork{\sampleN{k}{\varq}}
\bobalice{}{k}{}
\alicework{s_{1}=x \cdot k+t_{1},s_{2}=y \cdot k+t_{2}}
\alicebob{}{s_{1},s_{2}}{}
\bobwork{g^{s_{1}}h^{s_{2}} \equalQ A^{k}T }
\end{array}
$$<p>This works because:</p><p>$$
g^{s_{1}}h^{s_{2}}=g^{xk+t_{1}}h^{yk+t_{2}}=g^{xk}h^{yk}g^{t_{1}}h^{t_{2}}=\left(g^{x}h^{y}\right)^{k}T=A^{k}T
$$</p><p>This is secure because, in order to trick Bob, Alice needs to break the discrete log problem.</p><p>A straightforward application of the Fiat-Shamir transform can turn this into a non-interactive proof. If Alice selects $k=\hash{g\Vert h\Vert A\Vert T}$, where the output of $\hash{}$ has the same bit length as $q$, she can proceed as though $k$ were selected uniformly at random. Bob can compute $k$ in the same way, and verify the rest of the proof from there.</p><h3 id=an-easy-proof-of-equal-commitments>An Easy Proof of Equal Commitments
<a class=anchor href=#an-easy-proof-of-equal-commitments>#</a></h3><p>Given two commitments to a secret $s$ using the same set of generators, call them $c_{1}=C\left(s,t_{1}\right)$ and $c_{2}=C\left(s,t_{2}\right)$, where $t_{2}\neq t_{1}$, Alice can easily show that both $c_{1}$ and $c_{2}$ commit to the same value. The simplest way, given by Pedersen, is for Alice to reveal $r=t_{1}-t_{2}\pmod{q}$ to Bob.</p><p>This works because Bob can check that</p><p>$$
c_{1}c_{2}^{-1}=g^{s}h^{t_{1}}g^{-s}h^{-t_{2}}=g^{s-s}h^{t_{1}-t_{2}}=h^{t_{1}-t_{2}}=h^{r}
$$</p><h3 id=proof-of-equal-commitments-with-different-binding-generators>Proof of Equal Commitments with Different Binding Generators
<a class=anchor href=#proof-of-equal-commitments-with-different-binding-generators>#</a></h3><p>Suppose Alice has $c_{1}=C_{g_{1},h}\left(s,t_{1}\right)$ and $c_{2}=C_{g_{2},h}\left(s,t_{2}\right)$, possibly with $g_{1}\neq g_{2}$. Alice can prove to Bob that $c_{1}$ and $c_{2}$ commit to the same value.</p><p>Alice starts by selecting random integers $\sampleN{r_{1},r_{2},r_{3}}{\varq}$, then computing $c_{3}=C_{g_{1},h}\left(r_{1},r_{2}\right)=g_{1}^{r_{1}}h^{r_{2}}$ and $c_{4}=C_{g_{2},h}\left(r_{1},r_{3}\right)=g_{2}^{r_{1}}h^{r_{3}}$. She sends $c_{3},c_{4}$ to Bob.</p><p>Bob selects a random challenge value $\sampleN{k}{\varq}$ and sends it to Alice.</p><p>Alice computes $z_{1}=ks+r_{1}$, $z_{2}=kt_{1}+r_{2}$, and $z_{3}=kt_{2}+r_{3}$ in $\mathbb{Z}_{q}$ and sends $z_{1},z_{2},z_{3}$ to Bob.</p><p>Bob then checks that $c_{3}c_{1}^{k}=C_{g_{1},h}\left(z_{1},z_{2}\right)$ and $c_{4}c_{2}^{k}=C_{g_{2},h}\left(z_{1},z_{3}\right)$. If the condition holds, Bob accepts the proof as valid.</p><p>This works because:</p><p>$$
c_{3}c_{1}^{k}=\left(g_{1}^{r_{1}}h^{r_{2}}\right)\left(g_{1}^{s}h^{t_{1}}\right)^{k}=g_{1}^{r_{1}}h^{r_{2}}g_{1}^{ks}h^{kt_{1}}=g_{1}^{ks+r_{1}}h^{kt_{1}+r_{2}}=g_{1}^{z_{1}}h^{z_{2}}=C_{g_{1},h}\left(z_{1},z_{2}\right)
$$</p><p>and</p><p>$$
c_{4}c^{k}_{2}=\left(g_{2}^{r_{1}}h^{r_{3}}\right)\left(g_{2}^{s}h^{t_{2}}\right)^{k}=g_{2}^{r_{1}}h^{r_{3}}g_{2}^{ks}h^{kt_{2}}=g_{2}^{ks+r_{1}}h^{kt_{2}+r_{3}}=g_{2}^{z_{1}}h^{z_{3}}=C_{g_{2},h}\left(z_{1},z_{3}\right)
$$</p><h4 id=in-diagram-form>In diagram form:
<a class=anchor href=#in-diagram-form>#</a></h4>$$
\begin{array}{c}
\work{\varalice}{\varbob}
\alicework{\sampleN{r_{1},r_{2},r_{3}}{\varq}}
\alicework{c_{3}=C_{g_{1},h}\left(r_{1},r_{2}\right),c_{4}=C_{g_{2},h}\left(r_{1},r_{3}\right)}
\alicebob{}{c_{3},c_{4}}{}
\bobwork{\sampleN{k}{\varq}}
\bobalice{}{k}{}
\alicework{z_{1}=ks+r_{1}\\ z_{2}=kt_{1}+r_{2}\\ z_{3}=kt_{2}+r_{3}}
\alicebob{}{z_{1},z_{2},z_{3}}{}
\bobwork{c_{3}c_{1}^{k}\equalQ C\left(z_{1},z_{2}\right)}
\bobwork{c_{4}c_{2}^{k}\equalQ C\left(z_{1},z_{3}\right)}
\end{array}
$$<p>Again, this can be made non-interactive through the use of a Fiat-Shamir transform. Alice can use $k=\hash{g_{1}\Vert g_{2}\Vert h\Vert c_{1}\Vert c_{2}\Vert c_{3}\Vert c_{4}}$, again selecting a hash so that $k$ and $q$ have the same bit length.</p><p>While this construction is more complicated, it has the benefit of allowing for commitments to be made when $g_{1}\neq g_{2}$.</p><h3 id=proof-of-squared-commitments>Proof of Squared Commitments
<a class=anchor href=#proof-of-squared-commitments>#</a></h3><p>We can use the equality of commitments proof above to commit to both a secret $s$ and its square.</p><p>Suppose Alice has a random $t_{1}$ and corresponding commitment $c_{1}=C_{g,h}\left(s,t_{1}\right)=g^{s}h^{t_{1}}$. Alice can select a random $t_{2}$ and compute $c_{2}=C_{c_{1},h}\left(s,t_{2}\right)=\left(c_{1}\right)^{s}h^{t_{2}}$</p><p>Note that $c_{2}=C_{c_{1},h}\left(s,t_{2}\right)=\left(c_{1}\right)^{s}h^{t_{2}}=\left(g^{s}h^{t_{1}}\right)^{s}h^{t_{2}}=g^{s^{2}}h^{st_{1}+t_{2}}=C_{g,h}\left(s^{2},st_{1}+t_{2}\right)$, so $c_{2}$ is a commitment to $s^{2}$ in base $g$.</p><p>Once $c_{1}$ has been generated, Alice can easily generate $c_{2}$, provide both values to Bob, and use the equality proof above to demonstrate that $c_{2}$ commits to the square of the value committed to by $c_{1}$.</p><h2 id=security-considerations>Security Considerations
<a class=anchor href=#security-considerations>#</a></h2><h3 id=generator-selection>Generator Selection
<a class=anchor href=#generator-selection>#</a></h3><p>Suppose that a Alice knows $l=\log_{g}\left(h\right)$ and has a commitment $c=C\left(s,t\right)=g^{s}h^{t}$.</p><p>Then Alice can rewrite the commitment as $c=g^{s}h^{t}$ as $c=g^{s}\left(g^{l}\right)^{t}=g^{s}g^{tl}=g^{s+tl}$. Let $s&rsquo;=s+l$ and $t&rsquo;=t-1$. She can the fraudulently &ldquo;open&rdquo; the commitment $c$ by sending $\left(s&rsquo;,t&rsquo;\right)$. This will appear as a valid opening to Bob, since:</p><p>$$
g^{s&rsquo;}h^{t&rsquo;}=g^{s+1}\left(g^{l}\right)^{t - 1}=g^{s+l}g^{l\left(t-1\right)}=g^{s+l}g^{tl-l}=g^{s+tl}=g^{s+tl}=c
$$</p><p>If the discrete logarithm of $h$ with respect to $g$ is known to Alice (or if an insecure group is chosen that makes computing the discrete log easy), <em>the binding property is lost</em>.</p><p>This is why it is important to ensure that generators $g$ and $h$ are selected independently. Ideally, $g$ and $h$ should be chosen independently from one another using a nothing-up-my-sleeve construction. For instance, $g$ and $h$ can be selected using an agreed-upon PRF and algorithm D.3.1 from the ANSI X9.62 standard (“Finding a Point on an Elliptic Curve”).</p><h3 id=random-number-generator-issues>Random Number Generator Issues
<a class=anchor href=#random-number-generator-issues>#</a></h3><p>In selecting the hiding value $\sampleN{t}{\varq}$, it is important that $t$ be truly uniform.</p><p>Suppose there is an attack on the process used to generate $t$, and we have a set of commitments $c_{1}, c_{2},\ldots,c_{n}$ to secrets $s_{1},s_{2},\ldots,s_{n}$, not necessarily distinct. An attacker can then attack each $h^{t_{i}}$ and recover the corresponding values for $g^{s_{i}}$. From this, the attacker can quickly identify repeated commitments to the same value. In cases where commitments are suspected of having a simple linear relationship (e.g. $s_{i}=k\cdot s_{j}$ or $s_{i}=s_{j} + k$ for some <em>known</em> value of $k$), these relationships can be recovered as well by examining $g^{s_{i}}g^{k}$ and $\left(g^{s_{i}}\right)^{k}$.</p><h2>References <a class=anchor href=#references>#</a></h2><ul><li>[Pedersen91] <a href=https://www.cs.cornell.edu/courses/cs754/2001fa/129.PDF title target=_blank>Non-Interactive and Information-Theoretic Secure Verifiable Secret Sharing</a> (1991).</li></ul><ul><li>[ANSIX962] <a href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.202.2977&amp;rep=rep1&amp;type=pdf" title target=_blank>ANS X9.62-1998, Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)</a> (1998).</li></ul></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script><article class=markdown><br><br><hr><div style=text-align:right><a href=https://github.com/trailofbits/zkdocs target=_blank>View on Github</a> | <a href=https://www.trailofbits.com/ target=_blank>Trail of Bits</a> |
<a href=https://blog.trailofbits.com/ target=_blank>Trail of Bits Blog</a></div><div style=text-align:right><small>ZKDocs content is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank>Creative Commons Attribution 4.0 International license.</a></small></div></article></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#definition>Definition</a><ul><li><a href=#intuition-as-to-why-pedersen-commitments-are-binding>Intuition as to Why Pedersen Commitments are Binding</a></li><li><a href=#intuition-as-to-why-pedersen-commitments-are-hiding>Intuition as to Why Pedersen Commitments are Hiding</a></li><li><a href=#the-additive-property>The Additive Property</a></li></ul></li><li><a href=#useful-algorithms-and-properties-of-pedersen-commitments>Useful Algorithms and Properties of Pedersen Commitments</a><ul><li><a href=#proof-of-knowledge-of-secret>Proof of Knowledge of Secret</a></li><li><a href=#an-easy-proof-of-equal-commitments>An Easy Proof of Equal Commitments</a></li><li><a href=#proof-of-equal-commitments-with-different-binding-generators>Proof of Equal Commitments with Different Binding Generators</a></li><li><a href=#proof-of-squared-commitments>Proof of Squared Commitments</a></li></ul></li><li><a href=#security-considerations>Security Considerations</a><ul><li><a href=#generator-selection>Generator Selection</a></li><li><a href=#random-number-generator-issues>Random Number Generator Issues</a></li></ul></li></ul></nav><br><br></div></aside></main></body></html>