<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Common variants of Schnorr&rsquo;s protocol.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="Variants of Schnorr's identification protocol">
<meta property="og:description" content="Common variants of Schnorr&rsquo;s protocol.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/"><meta property="article:section" content="docs">
<title>Variants of Schnorr's identification protocol | ZKDocs</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.c8710a7ee94192e48449fd4ec6671dcefe3aa106844b835a6a46d1754d1839ec.css integrity="sha256-yHEKfulBkuSESf1Oxmcdzv46oQaES4NaakbRdU0YOew=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.44bd8ca13fab1fa4891638408a842ccb19038478cd9b653d95408f4e1f33a793.js integrity="sha256-RL2MoT+rH6SJFjhAioQsyxkDhHjNm2U9lUCPTh8zp5M=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-215689345-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>ZKDocs</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/>Introduction</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/notation/>Notation & Definitions</a>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/>Zero-knowledge protocols</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/>Schnorr's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/ class=active>Variants of Schnorr's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/>Number is product of two primes</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/square-freeness/>Number is square-free</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/two-prime-divisors/>Two prime divisors</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/product-of-two-primes/>Product of two primes</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/paillier_blum_modulus/>Paillier-Blum Modulus</a>
</li>
</ul>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/girault-identification/>Girault's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/short-factoring-proofs/>Short factoring proofs</a>
</li>
</ul>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/>Security of ZKPs</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/when-to-use-hvzk/>Using HVZKP in the wrong context</a>
</li>
</ul>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/>Protocol primitives</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/random-sampling/>Random Sampling</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/nums/>Nothing-up-my-sleeve constructions</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/shamir/>Shamir's Secret Sharing Scheme</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/verifiable-secret-sharing/>Feldman's Verifiable Secret Sharing</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/alt-shamir/>Alternative versions of Shamir's Secret Sharing scheme</a>
</li>
</ul>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/bibliography/>Bibliography</a>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<script type=text/x-mathjax-config>
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},SVG: {addMMLclasses: true},
  loader: { load: ['[tex]/textmacros','[tex]/newcommand','[tex]/action'] },
  tex: { packages: { '[+]': ['newcommand','action', 'textmacros'] } }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML-full"></script>
<script language=javascript type=text/javascript src=/js/interactive_variables.js></script>
<script>MathJax.Hub.Queue(function(){setupInteractiveVariables()})</script>
$\newcommand{\alicebob}[3]{#1 & \ra{#2} & #3\\[-5pt]}$
$\newcommand{\bobalice}[3]{#1 & \la{#2} & #3\\[-5pt]}$
$\newcommand{\alicework}[1]{#1 & &\\[-5pt]}$
$\newcommand{\bobwork}[1]{ & & #1\\[-5pt]}$
$\newcommand{\work}[2]{#1 & & #2\\}$
$\newcommand{\allwork}[1]{ & #1 & \\}$
$\newcommand{\aliceseparator}{-------&&\\}$
$\newcommand{\bobseparator}{&&-------\\}$
$\newcommand{\foo}{\phantom{\text{bigarrowfitsallthis}}}$
$\newcommand{\ra}[1]{%
\vphantom{\xrightarrow{asd}}%
\smash{\xrightarrow[\foo]{#1}}%
}$
$\newcommand{\la}[1]{%
\vphantom{\xleftarrow{asd}}%
\smash{\xleftarrow[\foo]{#1}}%
}$
$\newcommand{\z}[1]{\mathbb{Z}_{#1}}$
$\newcommand{\zq}{\mathbb{Z}_\varq}$
$\newcommand{\zqs}{\mathbb{Z}_q^\ast}$
$\newcommand{\zns}[1]{\mathbb{Z}_{#1}^\ast}$
$\require{action}
\newcommand{\sampleSymb}{
{\overset{\$}{\leftarrow}}
}$
$\newcommand{\field}[1]{\mathbb{F}_{#1}}$
$\newcommand{\sample}[1]{#1\sampleSymb\zq}$
$\newcommand{\sampleGeneric}[2]{#1\sampleSymb#2}$
$\newcommand{\sampleInterval}[2]{#1\sampleSymb\interval{#2}}$
$\newcommand{\sampleRange}[2]{#1\sampleSymb\range{#2}}$
$\newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}}$
$\newcommand{\sampleN}[2]{\class{hover}{#1\sampleSymb\z{#2}}}$
$\newcommand{\sampleNs}[2]{\class{hover}{#1\sampleSymb\z{#2}^\ast}}$
$\newcommand{\equalQ}{\overset{?}{=}}$
$\newcommand{\gQ}{\overset{?}{>}}$
$\newcommand{\inQ}{\overset{?}{\in}}$
$\newcommand{\cgroup}{\mathbb{G}}$
$\newcommand{\hash}[1]{\mathsf{Hash}({#1})}$
$\newcommand{\hashbit}[2]{\mathsf{Hash}({#1})\verb+[0:#2]+}$
$\newcommand{\naturals}{\mathbb{N}}$
$\newcommand{\sqfree}{L_\mathsf{square-free}}$
$\newcommand{\ceil}[1]{\lceil #1 \rceil}$
$\newcommand{\sampleSet}[2]{\class{hover}{#1\sampleSymb#2}}$
$\newcommand{\bunch}[1]{\{ #1_i\}_{i=1}^m}$
$\newcommand{\bunchi}[1]{\{ #1\}_{i=1}^m}$
$\newcommand{\forb}{\text{ for }i=1,\ldots,m}$
$\newcommand{\interval}[1]{[0, #1[}$
$\newcommand{\range}[1]{[#1]}$
$\newcommand{\rangeone}[1]{\{1, \dots,#1 -1 \}}$
$\newcommand{\vara}{\class{var var_a}{a}}$
$\newcommand{\varb}{\class{var var_b}{b}}$
$\newcommand{\varc}{\class{var var_c}{c}}$
$\newcommand{\vard}{\class{var var_d}{d}}$
$\newcommand{\varh}{\class{var var_h}{h}}$
$\newcommand{\varg}{\class{var var_g}{g}}$
$\newcommand{\varu}{\class{var var_u}{u}}$
$\newcommand{\varx}{\class{var var_x}{x}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varz}{\class{var var_z}{z}}$
$\newcommand{\varr}{\class{var var_r}{r}}$
$\newcommand{\varq}{\class{var var_q}{q}}$
$\newcommand{\varp}{\class{var var_p}{p}}$
$\newcommand{\vare}{\class{var var_e}{e}}$
$\newcommand{\vary}{\class{var var_y}{y}}$
$\newcommand{\varw}{\class{var var_w}{w}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}}$
$\newcommand{\varN}{\class{var var_N}{N}}$
$\newcommand{\rhovar}{\class{var var_ρ}{\rho}}$
$\newcommand{\sigmavar}{\class{var var_σ}{\sigma}}$
$\newcommand{\thetavar}{\class{var var_θ}{\theta}}$
$\newcommand{\muvar}{\class{var var_μ}{\mu}}$
$\newcommand{\true}{\mathsf{true}}$
$\newcommand{\false}{\mathsf{false}}$
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Variants of Schnorr's identification protocol</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li><a href=#non-interactive-protocols>Non-interactive protocols</a>
<ul>
<li><a href=#original>Original</a></li>
<li><a href=#slim-original>Slim Original</a></li>
<li><a href=#subtract>Subtract</a></li>
<li><a href=#subtract--derive>Subtract + Derive</a></li>
</ul>
</li>
<li><a href=#security-pitfalls>Security pitfalls</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=variants-of-schnorrs-identification-protocol>
Variants of Schnorr&rsquo;s identification protocol
<a class=anchor href=#variants-of-schnorrs-identification-protocol>#</a>
</h1>
<p>All variants of Schnorr&rsquo;s protocol prove the knowledge of an $\varx$ such that $\varh = \varg^\varx$ for a public $\varh$.</p>
<p>The differences are tradeoffs between the size of the proof statements and a more costly proof verification, and smaller communication overhead.</p>
<blockquote class="book-hint info">
<strong>Goal:</strong>
$\varprover$ convinces $\varverifier$ that they know $\varx$ such that $\varh = \varg^\varx$
</blockquote>
<ul>
<li><strong>Public input:</strong> cyclic group $\cgroup$ of prime order $\varq$, a $\cgroup$ generator $\varg$ and $\varh\in \cgroup$.</li>
<li><strong>Private input:</strong> $\varprover$ knows secret $\varx\in\zq$ such that $\varh = \varg^\varx$.</li>
</ul>
<p>We present all variants in their non-interactive version.</p>
<h2 id=non-interactive-protocols>
Non-interactive protocols
<a class=anchor href=#non-interactive-protocols>#</a>
</h2>
<h3 id=original>
Original
<a class=anchor href=#original>#</a>
</h3>
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\sampleNs{\varr}{\varq}}
\alicework{\varu = \varg^\varr}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varu, \varc, \varz}{}
\bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
\bobwork{\varg^\varz \equalQ \varu \cdot \varh ^\varc }
\end{array}
$$
<hr>
<h3 id=slim-original>
Slim Original
<a class=anchor href=#slim-original>#</a>
</h3>
<p>In this variant, the prover does not send the value of $\varc$ which has to be computed by the verifier.
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\sampleNs{\varr}{\varq}}
\alicework{\varu = \varg^\varr}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr + \varx\cdot \varc}
\alicebob{}{\varu, \varz}{}
\bobwork{\bar{\varc} = \hash{\varg, \varq, \varh, \varu}}
\bobwork{\varg^\varz \equalQ \varu \cdot \varh ^\overline{\varc} }
\end{array}
$$
</p>
<hr>
<h3 id=subtract>
Subtract
<a class=anchor href=#subtract>#</a>
</h3>
<p>In this variant, the prover uses a subtraction to compute the value of $\varz$.</p>
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\sampleNs{\varr}{\varq}}
\alicework{\varu = \varg^\varr}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr - \varx\cdot \varc}
\alicebob{}{\varu, \varc, \varz}{}
\bobwork{\varc \equalQ \hash{\varg, \varq, \varh, \varu}}
\bobwork{\varg^\varz \cdot \varh ^\varc \equalQ \varu }
\end{array}
$$
<hr>
<h3 id=subtract--derive>
Subtract + Derive
<a class=anchor href=#subtract--derive>#</a>
</h3>
<p>In this variant, the prover uses a subtraction to compute the value of $\varz$ and does not send $\varu$, which the verifier derives from the values they know.</p>
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\sampleNs{\varr}{\varq}}
\alicework{\varu = \varg^\varr}
\alicework{\varc = \hash{\varg, \varq, \varh, \varu}}
\alicework{\varz = \varr - \varx\cdot \varc}
\alicebob{}{\varc, \varz}{}
\bobwork{\bar{\varu} = \varg^\varz \cdot \varh^\varc}
\bobwork{\bar{\varc} = \hash{\varg, \varq, \varh, \bar{\varu}}}
\bobwork{\varc \equalQ \bar{\varc} }
\end{array}
$$
<h2 id=security-pitfalls>
Security pitfalls
<a class=anchor href=#security-pitfalls>#</a>
</h2>
<p>These variants suffer from the same pitfalls as the original Schnorr scheme, with some adjustments when $\varz$ is computed with a subtraction:</p>
<ul>
<li><strong>Verifier trusts prover:</strong>
<ul>
<li>$\varverifier$ uses $g$ and $q$ provided in the proof instead of using publicly known values.</li>
<li>When the $varprover$ sends $\varc$, if the $\varverifier$ assumes that the hash $\varc$ is correctly computed and does not compute it themself. Both are high severity issues since $\varprover$ can forge proofs.</li>
</ul>
</li>
<li><strong>Weak Fiat-Shamir transformation:</strong> It is a common issue that some parameters are missing on the hash computation $\hash{\varg, \varq, \varh, \varu}$:
<ul>
<li>$\varh$ or $\varu$ missing: high severity issue. Read <a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a> for more details.</li>
<li>$\varg$ or $\varq$ missing: usually no issue, but it might be one if the Verifier uses these parameters directly from the proof structure. This way, the prover can provide bad generators or orders to forge the proof.</li>
</ul>
</li>
<li><strong>Weak randomness:</strong> Bad randomness may cause the secret $\varx$ to leak. If $\varr$ is reused twice with two different non-interactive challenges then:
$$ \frac{\varz - \varz'}{\varc-\varc'} = \frac{\varr -\varr + \varx\cdot(\varc - \varc')}{\varc-\varc'} = \varx \enspace,$$
or when $\varz$ is computed with a subtraction:
$$ \frac{\varz - \varz'}{\varc'-\varc} = \frac{\varr -\varr + \varx\cdot(\varc' - \varc)}{\varc'-\varc} = \varx \enspace.$$</li>
<li><strong>Replay attacks:</strong> After a non-interactive proof is public, it will always be valid and anyone could pretend to know the secret value. To prevent this, consider adding the ID of both the prover and the verifier inside of the Fiat-Shamir hash computation.</li>
</ul>
<h2>References <a class=anchor href=#references>#</a></h2>
<ul>
<li>[RFC] <a href=https://www.rfc-editor.org/rfc/rfc8235.html title="RFC: Schnorr Non-interactive Zero-Knowledge Proof" target=_blank>Informational RFC: Schnorr Non-interactive Zero-Knowledge Proof</a> (2017).</li>
</ul>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
<article class=markdown>
<br>
<br>
<hr>
<div style=text-align:right>
<a href=https://github.com/trailofbits/zkdocs target=_blank>View on Github</a> | <a href=https://www.trailofbits.com/ target=_blank>Trail of Bits</a> |
<a href=https://blog.trailofbits.com/ target=_blank>Trail of Bits Blog</a>
</div>
<div style=text-align:right>
<small>ZKDocs content is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank>Creative Commons Attribution 4.0 International license.</a></small>
</div>
</article>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#non-interactive-protocols>Non-interactive protocols</a>
<ul>
<li><a href=#original>Original</a></li>
<li><a href=#slim-original>Slim Original</a></li>
<li><a href=#subtract>Subtract</a></li>
<li><a href=#subtract--derive>Subtract + Derive</a></li>
</ul>
</li>
<li><a href=#security-pitfalls>Security pitfalls</a></li>
</ul>
</nav>
<br>
<br>
<button onclick=resetVariableNames()>Reset variables names</button>
</div>
</aside>
</main>
</body>
</html>