<!doctype html><html lang=en dir=ltr>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="A statistical zero-knowledge proof for discrete-logarithm in a composite modulo.">
<meta name=theme-color content="#FFFFFF">
<meta name=color-scheme content="light dark"><meta property="og:title" content="Girault's identification protocol">
<meta property="og:description" content="A statistical zero-knowledge proof for discrete-logarithm in a composite modulo.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/girault-identification/"><meta property="article:section" content="docs">
<title>Girault's identification protocol | ZKDocs</title>
<link rel=manifest href=/manifest.json>
<link rel=icon href=/favicon.png type=image/x-icon>
<link rel=stylesheet href=/book.min.c8710a7ee94192e48449fd4ec6671dcefe3aa106844b835a6a46d1754d1839ec.css integrity="sha256-yHEKfulBkuSESf1Oxmcdzv46oQaES4NaakbRdU0YOew=" crossorigin=anonymous>
<script defer src=/flexsearch.min.js></script>
<script defer src=/en.search.min.44bd8ca13fab1fa4891638408a842ccb19038478cd9b653d95408f4e1f33a793.js integrity="sha256-RL2MoT+rH6SJFjhAioQsyxkDhHjNm2U9lUCPTh8zp5M=" crossorigin=anonymous></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-215689345-1','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body dir=ltr>
<input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control>
<main class="container flex">
<aside class=book-menu>
<div class=book-menu-content>
<nav>
<h2 class=book-brand>
<a class="flex align-center" href=/><img src=/logo.png alt=Logo><span>ZKDocs</span>
</a>
</h2>
<div class=book-search>
<input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/>
<div class="book-search-spinner hidden"></div>
<ul id=book-search-results></ul>
</div>
<ul>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/>Introduction</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/notation/>Notation & Definitions</a>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/>Zero-knowledge protocols</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr/>Schnorr's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/schnorr-variants/>Variants of Schnorr's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/>Number is product of two primes</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/square-freeness/>Number is square-free</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/two-prime-divisors/>Two prime divisors</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/product-of-two-primes/>Product of two primes</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/product-primes/paillier_blum_modulus/>Paillier-Blum Modulus</a>
</li>
</ul>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/girault-identification/ class=active>Girault's identification protocol</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/zero-knowledge-protocols/short-factoring-proofs/>Short factoring proofs</a>
</li>
</ul>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/>Security of ZKPs</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/security-of-zkps/when-to-use-hvzk/>Using HVZKP in the wrong context</a>
</li>
</ul>
</li>
<li class=book-section-flat>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/>Protocol primitives</a>
<ul>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/random-sampling/>Random Sampling</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/fiat-shamir/>Fiat-Shamir transformation</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/nums/>Nothing-up-my-sleeve constructions</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/shamir/>Shamir's Secret Sharing Scheme</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/verifiable-secret-sharing/>Feldman's Verifiable Secret Sharing</a>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/protocol-primitives/alt-shamir/>Alternative versions of Shamir's Secret Sharing scheme</a>
</li>
</ul>
</li>
<li>
<a href=https://www.zkdocs.com/docs/zkdocs/bibliography/>Bibliography</a>
</li>
</ul>
</li>
</ul>
</nav>
<script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>
</div>
</aside>
<div class=book-page>
<header class=book-header>
<script type=text/x-mathjax-config>
  MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]},SVG: {addMMLclasses: true},
  loader: { load: ['[tex]/textmacros','[tex]/newcommand','[tex]/action'] },
  tex: { packages: { '[+]': ['newcommand','action', 'textmacros'] } }
});
</script>
<script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_CHTML-full"></script>
<script language=javascript type=text/javascript src=/js/interactive_variables.js></script>
<script>MathJax.Hub.Queue(function(){setupInteractiveVariables()})</script>
$\newcommand{\alicebob}[3]{#1 & \ra{#2} & #3\\[-5pt]}$
$\newcommand{\bobalice}[3]{#1 & \la{#2} & #3\\[-5pt]}$
$\newcommand{\alicework}[1]{#1 & &\\[-5pt]}$
$\newcommand{\bobwork}[1]{ & & #1\\[-5pt]}$
$\newcommand{\work}[2]{#1 & & #2\\}$
$\newcommand{\allwork}[1]{ & #1 & \\}$
$\newcommand{\aliceseparator}{-------&&\\}$
$\newcommand{\bobseparator}{&&-------\\}$
$\newcommand{\foo}{\phantom{\text{bigarrowfitsallthis}}}$
$\newcommand{\ra}[1]{%
\vphantom{\xrightarrow{asd}}%
\smash{\xrightarrow[\foo]{#1}}%
}$
$\newcommand{\la}[1]{%
\vphantom{\xleftarrow{asd}}%
\smash{\xleftarrow[\foo]{#1}}%
}$
$\newcommand{\z}[1]{\mathbb{Z}_{#1}}$
$\newcommand{\zq}{\mathbb{Z}_\varq}$
$\newcommand{\zqs}{\mathbb{Z}_q^\ast}$
$\newcommand{\zns}[1]{\mathbb{Z}_{#1}^\ast}$
$\require{action}
\newcommand{\sampleSymb}{
{\overset{\$}{\leftarrow}}
}$
$\newcommand{\field}[1]{\mathbb{F}_{#1}}$
$\newcommand{\sample}[1]{#1\sampleSymb\zq}$
$\newcommand{\sampleGeneric}[2]{#1\sampleSymb#2}$
$\newcommand{\sampleInterval}[2]{#1\sampleSymb\interval{#2}}$
$\newcommand{\sampleRange}[2]{#1\sampleSymb\range{#2}}$
$\newcommand{\samplezqs}[1]{\class{hover}{#1\sampleSymb\zqs}}$
$\newcommand{\sampleN}[2]{\class{hover}{#1\sampleSymb\z{#2}}}$
$\newcommand{\sampleNs}[2]{\class{hover}{#1\sampleSymb\z{#2}^\ast}}$
$\newcommand{\equalQ}{\overset{?}{=}}$
$\newcommand{\gQ}{\overset{?}{>}}$
$\newcommand{\inQ}{\overset{?}{\in}}$
$\newcommand{\cgroup}{\mathbb{G}}$
$\newcommand{\hash}[1]{\mathsf{Hash}({#1})}$
$\newcommand{\hashbit}[2]{\mathsf{Hash}({#1})\verb+[0:#2]+}$
$\newcommand{\naturals}{\mathbb{N}}$
$\newcommand{\sqfree}{L_\mathsf{square-free}}$
$\newcommand{\ceil}[1]{\lceil #1 \rceil}$
$\newcommand{\sampleSet}[2]{\class{hover}{#1\sampleSymb#2}}$
$\newcommand{\bunch}[1]{\{ #1_i\}_{i=1}^m}$
$\newcommand{\bunchi}[1]{\{ #1\}_{i=1}^m}$
$\newcommand{\forb}{\text{ for }i=1,\ldots,m}$
$\newcommand{\interval}[1]{[0, #1[}$
$\newcommand{\range}[1]{[#1]}$
$\newcommand{\rangeone}[1]{\{1, \dots,#1 -1 \}}$
$\newcommand{\vara}{\class{var var_a}{a}}$
$\newcommand{\varb}{\class{var var_b}{b}}$
$\newcommand{\varc}{\class{var var_c}{c}}$
$\newcommand{\vard}{\class{var var_d}{d}}$
$\newcommand{\varh}{\class{var var_h}{h}}$
$\newcommand{\varg}{\class{var var_g}{g}}$
$\newcommand{\varu}{\class{var var_u}{u}}$
$\newcommand{\varx}{\class{var var_x}{x}}$
$\newcommand{\varX}{\class{var var_X}{X}}$
$\newcommand{\varz}{\class{var var_z}{z}}$
$\newcommand{\varr}{\class{var var_r}{r}}$
$\newcommand{\varq}{\class{var var_q}{q}}$
$\newcommand{\varp}{\class{var var_p}{p}}$
$\newcommand{\vare}{\class{var var_e}{e}}$
$\newcommand{\vary}{\class{var var_y}{y}}$
$\newcommand{\varw}{\class{var var_w}{w}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varprover}{\class{var var_Prover}{\text{Prover}}}$
$\newcommand{\varverifier}{\class{var var_Verifier}{\text{Verifier}}}$
$\newcommand{\varN}{\class{var var_N}{N}}$
$\newcommand{\rhovar}{\class{var var_ρ}{\rho}}$
$\newcommand{\sigmavar}{\class{var var_σ}{\sigma}}$
$\newcommand{\thetavar}{\class{var var_θ}{\theta}}$
$\newcommand{\muvar}{\class{var var_μ}{\mu}}$
$\newcommand{\true}{\mathsf{true}}$
$\newcommand{\false}{\mathsf{false}}$
<div class="flex align-center justify-between">
<label for=menu-control>
<img src=/svg/menu.svg class=book-icon alt=Menu>
</label>
<strong>Girault's identification protocol</strong>
<label for=toc-control>
<img src=/svg/toc.svg class=book-icon alt="Table of Contents">
</label>
</div>
<aside class="hidden clearfix">
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#interactive-protocol>Interactive protocol</a></li>
<li><a href=#non-interactive-protocol>Non-interactive protocol</a></li>
</ul>
</li>
<li><a href=#security-pitfalls>Security pitfalls</a></li>
<li><a href=#choice-of-parameter-values>Choice of parameter values</a></li>
<li><a href=#auxiliary-procedures>Auxiliary procedures</a></li>
</ul>
</nav>
</aside>
</header>
<article class=markdown><h1 id=giraults-identification-protocol>
Girault&rsquo;s identification protocol
<a class=anchor href=#giraults-identification-protocol>#</a>
</h1>
<p>This scheme is a zero-knowledge proof for a discrete logarithm, like <a href=schnorr.md>Schnorr&rsquo;s</a> <a href=schnorr-variants.md>protocol</a>, but over a composite modulus instead of a prime modulus.</p>
<blockquote class="book-hint info">
<strong>Goal:</strong>
$\varprover$ convinces $\varverifier$ that they know $\varx$ such that $\varh = \varg^{-\varx} \mod \varN$
</blockquote>
<ul>
<li><strong>Public input:</strong> $\varh, \varN$ and a high order generator $\varg\in \zns{\varN}$</li>
<li><strong>Private input:</strong> $\varprover$ knows the secret $\varx\in \range{S}$</li>
<li><strong>Security parameters:</strong> The parameters $k, k', S$ and $R = 2^{k+k' + |S|}$.</li>
</ul>
<h3 id=interactive-protocol>
Interactive protocol
<a class=anchor href=#interactive-protocol>#</a>
</h3>
<blockquote class="book-hint danger">
<strong>Security note:</strong>
The interactive identification protocol assumes an honest verifier and should not be used in the context of malicious verifiers. A malicious verifier can send $\vare = R$ and recover the secret $\varx$ by dividing $\varz$ by $\vare$.
</blockquote>
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\varh = \varg^{-\varx} \mod \varN}
\alicework{\sampleRange{\varr}{R}}
\alicework{\varu = \varg^\varr \mod \varN}
\alicebob{}{\varu}{}
\bobwork{\sampleRange{\vare}{2^k}}
\bobalice{}{\vare}{}
\alicework{\varz = \varr + \varx\cdot \vare \in \naturals}
\alicebob{}{\varz}{}
\bobwork{\varu \equalQ \varg^{\varz} \cdot \varh^\vare \mod \varN}
\end{array}
$$
<hr>
<h3 id=non-interactive-protocol>
Non-interactive protocol
<a class=anchor href=#non-interactive-protocol>#</a>
</h3>
<p>We obtain a non-interactive protocol using the Fiat-Shamir heuristic, where the prover
creates the random $k$-bit challenge $\vare$ using domain-separated hash function over the $\{\varg, \varN, \varh, \varu\}$ parameters.
$$
\begin{array}{c}
\work{\varprover}{\varverifier}
\alicework{\varh = \varg^{-\varx} \mod \varN}
\alicework{\sampleRange{\varr}{R}}
\alicework{\varu = \varg^\varr \mod \varN}
\alicework{\vare = \hashbit{\varg, \varN, \varh, \varu}{k}}
\alicework{\varz = \varr + \varx\cdot \vare \in \naturals}
\alicebob{}{\varu, \vare, \varz}{}
\bobwork{\vare \equalQ \hashbit{\varg, \varN, \varh, \varu}{k}}
\bobwork{\varu \equalQ \varg^{\varz} \cdot \varh^\vare \mod \varN}
\end{array}
$$
</p>
<h2 id=security-pitfalls>
Security pitfalls
<a class=anchor href=#security-pitfalls>#</a>
</h2>
<ul>
<li><strong>Parameter choice:</strong> Implementers must pay special attention to the choice of parameter values, in particular the relation between $2^k$ and $R$. If these were of similar size, since $\varz$ is computed over the naturals, $\varx$ would be approximately $\lfloor \varz/\vare\rfloor$.</li>
<li><strong>Using the interactive protocol in a malicious verifier context:</strong> high severity issue which allows recovering the secret $\varx$; see <a href=/docs/zkdocs/security-of-zkps/when-to-use-hvzk/>Using HVZKP in the wrong context</a>.</li>
<li><strong>Verifier trusting prover on the non-interactive protocol:</strong>
<ul>
<li>$\varverifier$ uses a $\varg$ value provided by $\varprover$ instead of using the standard generator: this is a high severity issue since the prover can trivially forge proofs (e.g., by sending $\varu=0, \varg=0$).</li>
<li>$\varverifier$ does not validate $\varu,\varh$ as valid elements of $\zns{\varN}$ (between 1 and $\varN-1$ and with $\gcd(k, \varN) = 1$): this allows replaying the <em>same</em> proof with <em>different</em> values adding multiples of $\varN$.</li>
</ul>
</li>
<li><strong>Replay attacks:</strong> After a non-interactive proof is public, it will always be valid, and anyone could pretend to know how to prove the original statement. To prevent this, consider adding additional information to the computation of the hash function: values such as an ID unique to the prover and verifier, and a timestamp. The verifier must use these values and check their validity to verify the proof.</li>
</ul>
<h2 id=choice-of-parameter-values>
Choice of parameter values
<a class=anchor href=#choice-of-parameter-values>#</a>
</h2>
<ul>
<li>$|\varN| = 2048$</li>
<li>$S = 2^{256}$</li>
<li>$k,k' = 128$</li>
</ul>
<h2 id=auxiliary-procedures>
Auxiliary procedures
<a class=anchor href=#auxiliary-procedures>#</a>
</h2>
<ul>
<li>
<ul>
<li><strong>Hash function $\hashbit{\cdot}{k}$:</strong> this hash function should be domain-separated and have a specific output size of $k$-bits. Using $\mathsf{TupleHash}$ satisfies these restrictions.</li>
</ul>
</li>
</ul>
<h2>References <a class=anchor href=#references>#</a></h2>
<ul>
<li>[Gir91] <a href=https://link.springer.com/content/pdf/10.1007%2F3-540-46416-6_42.pdf title="Girault, M. (1991, April). Self-certified public keys. In Workshop on the Theory and Application of of Cryptographic Techniques (pp. 490-497). Springer, Berlin, Heidelberg." target=_blank>Self-certified public keys</a> (1991).</li>
</ul>
<ul>
<li>[Poi00] <a href=https://www.di.ens.fr/david.pointcheval/Documents/Papers/2000_pkcA.pdf title="Pointcheval, D. (2000, January). The composite discrete logarithm and secure authentication. In International Workshop on Public Key Cryptography (pp. 113-128). Springer, Berlin, Heidelberg." target=_blank>The composite discrete logarithm and secure authentication</a> (2000).</li>
</ul>
</article>
<footer class=book-footer>
<div class="flex flex-wrap justify-between">
</div>
<script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script>
<article class=markdown>
<br>
<br>
<hr>
<div style=text-align:right>
<a href=https://github.com/trailofbits/zkdocs target=_blank>View on Github</a> | <a href=https://www.trailofbits.com/ target=_blank>Trail of Bits</a> |
<a href=https://blog.trailofbits.com/ target=_blank>Trail of Bits Blog</a>
</div>
<div style=text-align:right>
<small>ZKDocs content is licensed under a <a href=https://creativecommons.org/licenses/by/4.0/ target=_blank>Creative Commons Attribution 4.0 International license.</a></small>
</div>
</article>
</footer>
<div class=book-comments>
</div>
<label for=menu-control class="hidden book-menu-overlay"></label>
</div>
<aside class=book-toc>
<div class=book-toc-content>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li><a href=#interactive-protocol>Interactive protocol</a></li>
<li><a href=#non-interactive-protocol>Non-interactive protocol</a></li>
</ul>
</li>
<li><a href=#security-pitfalls>Security pitfalls</a></li>
<li><a href=#choice-of-parameter-values>Choice of parameter values</a></li>
<li><a href=#auxiliary-procedures>Auxiliary procedures</a></li>
</ul>
</nav>
<br>
<br>
<button onclick=resetVariableNames()>Reset variables names</button>
</div>
</aside>
</main>
</body>
</html>